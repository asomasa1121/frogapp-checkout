<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout</title>
    <script src="https://sandbox-cdn.paddle.com/paddle/v2/paddle.js"></script>
</head>
<body style="font-family: sans-serif; text-align: center; padding-top: 50px;">
    <h1>Processing Payment...</h1>
    <div id="status">Loading...</div>

    <script>
        Paddle.Environment.set('sandbox'); 
        Paddle.Initialize({ 
            token: "test_3d7966c6a195ef6b87bede70f51",
            eventCallback: function(data) {
                // Listen for checkout completion
                if (data.name === "checkout.completed") {
                    var txnId = data.data.transaction_id;
                    document.getElementById("status").innerText = "Success! Returning to app...";
                    
                    // DEEP LINK to app
                    window.location.href = "frogapp://license-callback?txn=" + txnId;
                }
            }
        });

        const urlParams = new URLSearchParams(window.location.search);
        const txnId = urlParams.get('_ptxn');

        if (txnId) {
            document.getElementById("status").innerText = "Opening secure checkout...";
            Paddle.Checkout.open({
                transactionId: txnId
            });
        } else {
             // If no ID, maybe show a close button or generic msg
            document.getElementById("status").innerText = "Waiting for transaction...";
        }
    </script>
</body>
</html>
